import{a as e}from"./chunk-FNJKWSPR.js";import{a as t}from"./chunk-FMRIJYNG.js";import{b as n,c as a,d as r}from"./chunk-BKSIEBAA.js";import{b as o,h as i}from"./chunk-YWRPWWKI.js";import{a as s,b as c,c as u,d as l,e as d}from"./chunk-JMSSU44E.js";import{a as h}from"./chunk-4UYSGV57.js";import{a as m}from"./chunk-VLPNAR64.js";import{a as f,b as w}from"./chunk-GE5NEIZC.js";import{e as p}from"./chunk-35CVRQTC.js";function x(e,t){this.center=s.clone(m(e,s.ZERO)),this.halfAxes=d.clone(m(t,d.ZERO))}x.packedLength=s.packedLength+d.packedLength,x.pack=function(e,t,n){return w.typeOf.object("value",e),w.defined("array",t),n=m(n,0),s.pack(e.center,t,n),d.pack(e.halfAxes,t,n+s.packedLength),t},x.unpack=function(e,t,n){return w.defined("array",e),t=m(t,0),p(n)||(n=new x),s.unpack(e,t,n.center),d.unpack(e,t+s.packedLength,n.halfAxes),n};var b=new s,y=new s,g=new s,M=new s,N=new s,O=new s,A=new d,T={unitary:new d,diagonal:new d};x.fromPoints=function(e,t){if(p(t)||(t=new x),!p(e)||0===e.length)return t.halfAxes=d.ZERO,t.center=s.ZERO,t;let n,a=e.length,r=s.clone(e[0],b);for(n=1;n<a;n++)s.add(r,e[n],r);let o=1/a;s.multiplyByScalar(r,o,r);let i=0,c=0,u=0,l=0,h=0,m=0,f;for(n=0;n<a;n++)i+=(f=s.subtract(e[n],r,y)).x*f.x,c+=f.x*f.y,u+=f.x*f.z,l+=f.y*f.y,h+=f.y*f.z,m+=f.z*f.z;i*=o,c*=o,u*=o,l*=o,h*=o,m*=o,A[0]=i,A[1]=c,A[2]=u,A[3]=c,A[4]=l,A[5]=h,A[6]=u,A[7]=h,A[8]=m;let w=d.computeEigenDecomposition(A,T),C=d.clone(w.unitary,t.halfAxes),P=d.getColumn(C,0,M),I=d.getColumn(C,1,N),R=d.getColumn(C,2,O),E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,U=-Number.MAX_VALUE,L=Number.MAX_VALUE,q=Number.MAX_VALUE,k=Number.MAX_VALUE;for(n=0;n<a;n++)f=e[n],E=Math.max(s.dot(P,f),E),S=Math.max(s.dot(I,f),S),U=Math.max(s.dot(R,f),U),L=Math.min(s.dot(P,f),L),q=Math.min(s.dot(I,f),q),k=Math.min(s.dot(R,f),k);P=s.multiplyByScalar(P,.5*(L+E),P),I=s.multiplyByScalar(I,.5*(q+S),I),R=s.multiplyByScalar(R,.5*(k+U),R);let z=s.add(P,I,t.center);return s.add(z,R,z),g.x=E-L,g.y=S-q,g.z=U-k,s.multiplyByScalar(g,.5,g),d.multiplyByScale(t.halfAxes,g,t.halfAxes),t};var C=new s,P=new s;function I(e,t,n,a,r,o,i,c,u,l,h){if(!p(r)||!p(o)||!p(i)||!p(c)||!p(u)||!p(l))throw new f("all extents (minimum/maximum X/Y/Z) are required.");p(h)||(h=new x);let m=h.halfAxes;d.setColumn(m,0,t,m),d.setColumn(m,1,n,m),d.setColumn(m,2,a,m);let w=C;w.x=(r+o)/2,w.y=(i+c)/2,w.z=(u+l)/2,P.x=(o-r)/2,P.y=(c-i)/2,P.z=(l-u)/2;let b=h.center;return w=d.multiplyByVector(m,w,w),s.add(e,w,b),d.multiplyByScale(m,P,m),h}var R=new c,E=new s,S=new c,U=new c,L=new c,q=new c,k=new c,z=new s,j=new s,_=new s,B=new s,W=new s,v=new u,V=new u,X=new u,D=new u,Y=new u,Z=new s,G=new s,F=new s,J=new s,K=new u,Q=new s,H=new s,$=new s,ee=new t(s.UNIT_X,0);x.fromRectangle=function(n,a,r,o,u){let d,w,x,b,y,g,M;if(!p(n))throw new f("rectangle is required");if(n.width<0||n.width>h.TWO_PI)throw new f("Rectangle width must be between 0 and 2 * pi");if(n.height<0||n.height>h.PI)throw new f("Rectangle height must be between 0 and pi");if(p(o)&&!h.equalsEpsilon(o.radii.x,o.radii.y,h.EPSILON15))throw new f("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");if(a=m(a,0),r=m(r,0),o=m(o,l.default),n.width<=h.PI){let s=i.center(n,R),l=new e(o.cartographicToCartesian(s,E),o);M=l.plane;let h=s.longitude,m=n.south<0&&n.north>0?0:s.latitude,f=c.fromRadians(h,n.north,r,S),p=c.fromRadians(n.west,n.north,r,U),N=c.fromRadians(n.west,m,r,L),O=c.fromRadians(n.west,n.south,r,q),A=c.fromRadians(h,n.south,r,k),T=o.cartographicToCartesian(f,z),C=o.cartographicToCartesian(p,j),P=o.cartographicToCartesian(N,_),Z=o.cartographicToCartesian(O,B),G=o.cartographicToCartesian(A,W),F=l.projectPointToNearestOnPlane(T,v),J=l.projectPointToNearestOnPlane(C,V),K=l.projectPointToNearestOnPlane(P,X),Q=l.projectPointToNearestOnPlane(Z,D),H=l.projectPointToNearestOnPlane(G,Y);return w=-(d=Math.min(J.x,K.x,Q.x)),b=Math.max(J.y,F.y),x=Math.min(Q.y,H.y),p.height=O.height=a,C=o.cartographicToCartesian(p,j),Z=o.cartographicToCartesian(O,B),y=Math.min(t.getPointDistance(M,C),t.getPointDistance(M,Z)),g=r,I(l.origin,l.xAxis,l.yAxis,l.zAxis,d,w,x,b,y,g,u)}let N=n.south>0,O=n.north<0,A=N?n.south:O?n.north:0,T=i.center(n,R).longitude,C=s.fromRadians(T,A,r,o,Z);C.z=0;let P=Math.abs(C.x)<h.EPSILON10&&Math.abs(C.y)<h.EPSILON10?s.UNIT_X:s.normalize(C,G),et=s.UNIT_Z,en=s.cross(P,et,F);M=t.fromPointNormal(C,P,ee);let ea=s.fromRadians(T+h.PI_OVER_TWO,A,r,o,J);d=-(w=s.dot(t.projectPointOntoPlane(M,ea,K),en)),b=s.fromRadians(0,n.north,O?a:r,o,Q).z,x=s.fromRadians(0,n.south,N?a:r,o,H).z;let er=s.fromRadians(n.east,A,r,o,$);return I(C,en,et,P,d,w,x,b,y=t.getPointDistance(M,er),g=0,u)},x.fromTransformation=function(e,t){return w.typeOf.object("transformation",e),p(t)||(t=new x),t.center=o.getTranslation(e,t.center),t.halfAxes=o.getMatrix3(e,t.halfAxes),t.halfAxes=d.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},x.clone=function(e,t){if(p(e))return p(t)?(s.clone(e.center,t.center),d.clone(e.halfAxes,t.halfAxes),t):new x(e.center,e.halfAxes)},x.intersectPlane=function(e,t){if(!p(e))throw new f("box is required.");if(!p(t))throw new f("plane is required.");let a=e.center,r=t.normal,o=e.halfAxes,i=r.x,c=r.y,u=r.z,l=Math.abs(i*o[d.COLUMN0ROW0]+c*o[d.COLUMN0ROW1]+u*o[d.COLUMN0ROW2])+Math.abs(i*o[d.COLUMN1ROW0]+c*o[d.COLUMN1ROW1]+u*o[d.COLUMN1ROW2])+Math.abs(i*o[d.COLUMN2ROW0]+c*o[d.COLUMN2ROW1]+u*o[d.COLUMN2ROW2]),h=s.dot(r,a)+t.distance;return h<=-l?n.OUTSIDE:h>=l?n.INSIDE:n.INTERSECTING};var et=new s,en=new s,ea=new s,er=new s,eo=new s,ei=new s;x.distanceSquaredTo=function(e,t){if(!p(e))throw new f("box is required.");if(!p(t))throw new f("cartesian is required.");let n=s.subtract(t,e.center,C),a=e.halfAxes,r=d.getColumn(a,0,et),o=d.getColumn(a,1,en),i=d.getColumn(a,2,ea),c=s.magnitude(r),u=s.magnitude(o),l=s.magnitude(i),m=!0,w=!0,x=!0;c>0?s.divideByScalar(r,c,r):m=!1,u>0?s.divideByScalar(o,u,o):w=!1,l>0?s.divideByScalar(i,l,i):x=!1;let b=!m+!w+!x,y,g,M;if(1===b){let e=r;y=o,g=i,w?x||(e=i,g=r):(e=o,y=r),M=s.cross(y,g,eo),e===r?r=M:e===o?o=M:e===i&&(i=M)}else if(2===b){y=r,w?y=o:x&&(y=i);let e=s.UNIT_Y;e.equalsEpsilon(y,h.EPSILON3)&&(e=s.UNIT_X),g=s.cross(y,e,er),s.normalize(g,g),M=s.cross(y,g,eo),s.normalize(M,M),y===r?(o=g,i=M):y===o?(i=g,r=M):y===i&&(r=g,o=M)}else 3===b&&(r=s.UNIT_X,o=s.UNIT_Y,i=s.UNIT_Z);ei.x=s.dot(n,r),ei.y=s.dot(n,o),ei.z=s.dot(n,i);let N=0,O;return ei.x<-c?N+=(O=ei.x+c)*O:ei.x>c&&(N+=(O=ei.x-c)*O),ei.y<-u?N+=(O=ei.y+u)*O:ei.y>u&&(N+=(O=ei.y-u)*O),ei.z<-l?N+=(O=ei.z+l)*O:ei.z>l&&(N+=(O=ei.z-l)*O),N};var es=new s,ec=new s;x.computePlaneDistances=function(e,t,n,r){if(!p(e))throw new f("box is required.");if(!p(t))throw new f("position is required.");if(!p(n))throw new f("direction is required.");p(r)||(r=new a);let o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,c=e.center,u=e.halfAxes,l=d.getColumn(u,0,et),h=d.getColumn(u,1,en),m=d.getColumn(u,2,ea),w=s.add(l,h,es);s.add(w,m,w),s.add(w,c,w);let x=s.subtract(w,t,ec),b=s.dot(n,x);return o=Math.min(b,o),i=Math.max(b,i),s.add(c,l,w),s.add(w,h,w),s.subtract(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.add(c,l,w),s.subtract(w,h,w),s.add(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.add(c,l,w),s.subtract(w,h,w),s.subtract(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,w),s.add(w,h,w),s.add(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,w),s.add(w,h,w),s.subtract(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,w),s.subtract(w,h,w),s.add(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,w),s.subtract(w,h,w),s.subtract(w,m,w),s.subtract(w,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),r.start=o,r.stop=i,r};var eu=new s,el=new s,ed=new s;x.computeCorners=function(e,t){w.typeOf.object("box",e),p(t)||(t=[new s,new s,new s,new s,new s,new s,new s,new s]);let n=e.center,a=e.halfAxes,r=d.getColumn(a,0,eu),o=d.getColumn(a,1,el),i=d.getColumn(a,2,ed);return s.clone(n,t[0]),s.subtract(t[0],r,t[0]),s.subtract(t[0],o,t[0]),s.subtract(t[0],i,t[0]),s.clone(n,t[1]),s.subtract(t[1],r,t[1]),s.subtract(t[1],o,t[1]),s.add(t[1],i,t[1]),s.clone(n,t[2]),s.subtract(t[2],r,t[2]),s.add(t[2],o,t[2]),s.subtract(t[2],i,t[2]),s.clone(n,t[3]),s.subtract(t[3],r,t[3]),s.add(t[3],o,t[3]),s.add(t[3],i,t[3]),s.clone(n,t[4]),s.add(t[4],r,t[4]),s.subtract(t[4],o,t[4]),s.subtract(t[4],i,t[4]),s.clone(n,t[5]),s.add(t[5],r,t[5]),s.subtract(t[5],o,t[5]),s.add(t[5],i,t[5]),s.clone(n,t[6]),s.add(t[6],r,t[6]),s.add(t[6],o,t[6]),s.subtract(t[6],i,t[6]),s.clone(n,t[7]),s.add(t[7],r,t[7]),s.add(t[7],o,t[7]),s.add(t[7],i,t[7]),t};var eh=new d;x.computeTransformation=function(e,t){w.typeOf.object("box",e),p(t)||(t=new o);let n=e.center,a=d.multiplyByUniformScale(e.halfAxes,2,eh);return o.fromRotationTranslation(a,n,t)};var em=new r;x.isOccluded=function(e,t){if(!p(e))throw new f("box is required.");if(!p(t))throw new f("occluder is required.");let n=r.fromOrientedBoundingBox(e,em);return!t.isBoundingSphereVisible(n)},x.prototype.intersectPlane=function(e){return x.intersectPlane(this,e)},x.prototype.distanceSquaredTo=function(e){return x.distanceSquaredTo(this,e)},x.prototype.computePlaneDistances=function(e,t,n){return x.computePlaneDistances(this,e,t,n)},x.prototype.computeCorners=function(e){return x.computeCorners(this,e)},x.prototype.computeTransformation=function(e){return x.computeTransformation(this,e)},x.prototype.isOccluded=function(e){return x.isOccluded(this,e)},x.equals=function(e,t){return e===t||p(e)&&p(t)&&s.equals(e.center,t.center)&&d.equals(e.halfAxes,t.halfAxes)},x.prototype.clone=function(e){return x.clone(this,e)},x.prototype.equals=function(e){return x.equals(this,e)};var ef=x;export{ef as a};