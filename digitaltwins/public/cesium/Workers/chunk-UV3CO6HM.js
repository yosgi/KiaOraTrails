import{a as e,c as a}from"./chunk-6BHHTHKE.js";import{a as t}from"./chunk-M5SITFFN.js";import{f as r}from"./chunk-YWRPWWKI.js";import{a as n,e as l}from"./chunk-JMSSU44E.js";import{a as o}from"./chunk-4UYSGV57.js";import{e as i}from"./chunk-35CVRQTC.js";var s={},u=new n,c=new n,y=new n,m=new n,d=[new n,new n],p=new n,g=new n,h=new n,f=new n,z=new n,w=new n,S=new n,x=new n,B=new n,E=new n,A=new r,D=new l;function N(a,t,i,s,y){let m,d=n.angleBetween(n.subtract(t,a,u),n.subtract(i,a,c)),p=s===e.BEVELED?1:Math.ceil(d/o.toRadians(5))+1,g=3*p,h=Array(g);h[g-3]=i.x,h[g-2]=i.y,h[g-1]=i.z,m=y?l.fromQuaternion(r.fromAxisAngle(n.negate(a,u),d/p,A),D):l.fromQuaternion(r.fromAxisAngle(a,d/p,A),D);let f=0;t=n.clone(t,u);for(let e=0;e<p;e++)t=l.multiplyByVector(m,t,t),h[f++]=t.x,h[f++]=t.y,h[f++]=t.z;return h}function b(e,a,t,r){let l=u;return r||(a=n.negate(a,a)),[(l=n.add(e,a,l)).x,l.y,l.z,t.x,t.y,t.z]}function P(e,a,t,r){let l=Array(e.length),o=Array(e.length),i=n.multiplyByScalar(a,t,u),s=n.negate(i,c),d=0,p=e.length-1;for(let a=0;a<e.length;a+=3){let t=n.fromArray(e,a,y),r=n.add(t,s,m);l[d++]=r.x,l[d++]=r.y,l[d++]=r.z;let u=n.add(t,i,m);o[p--]=u.z,o[p--]=u.y,o[p--]=u.x}return r.push(l,o),r}s.addAttribute=function(e,a,t,r){let n=a.x,l=a.y,o=a.z;i(t)&&(e[t]=n,e[t+1]=l,e[t+2]=o),i(r)&&(e[r]=o,e[r-1]=l,e[r-2]=n)};var R=new n,v=new n;s.computePositions=function(r){var l;let i,s,c,y,m,A,D,U,j=r.granularity,k=r.positions,O=r.ellipsoid,V=r.width/2,M=r.cornerType,T=r.saveAttributes,I=p,L=g,H=h,Q=f,W=z,C=w,F=S,G=x,K=B,Y=E,q=[],J=T?[]:void 0,X=T?[]:void 0,Z=k[0],$=k[1];L=n.normalize(n.subtract($,Z,L),L),I=O.geodeticSurfaceNormal(Z,I),Q=n.normalize(n.cross(I,L,Q),Q),T&&(J.push(Q.x,Q.y,Q.z),X.push(I.x,I.y,I.z)),F=n.clone(Z,F),Z=$,H=n.negate(L,H);let _,ee=[],ea,et=k.length;for(ea=1;ea<et-1;ea++){I=O.geodeticSurfaceNormal(Z,I),$=k[ea+1],L=n.normalize(n.subtract($,Z,L),L);let r=n.multiplyByScalar(I,n.dot(L,I),R);n.subtract(L,r,r),n.normalize(r,r);let l=n.multiplyByScalar(I,n.dot(H,I),v);if(n.subtract(H,l,l),n.normalize(l,l),!o.equalsEpsilon(Math.abs(n.dot(r,l)),1,o.EPSILON7)){W=n.normalize(n.add(L,H,W),W),W=n.cross(W,I,W),W=n.cross(I,W,W),W=n.normalize(W,W);let r=V/Math.max(.25,n.magnitude(n.cross(W,H,u))),l=a.angleIsGreaterThanPi(L,H,Z,O);W=n.multiplyByScalar(W,r,W),l?(G=n.add(Z,W,G),Y=n.add(G,n.multiplyByScalar(Q,V,Y),Y),K=n.add(G,n.multiplyByScalar(Q,2*V,K),K),d[0]=n.clone(F,d[0]),d[1]=n.clone(Y,d[1]),q=P(t.generateArc({positions:d,granularity:j,ellipsoid:O}),Q,V,q),T&&(J.push(Q.x,Q.y,Q.z),X.push(I.x,I.y,I.z)),C=n.clone(K,C),Q=n.normalize(n.cross(I,L,Q),Q),K=n.add(G,n.multiplyByScalar(Q,2*V,K),K),F=n.add(G,n.multiplyByScalar(Q,V,F),F),M===e.ROUNDED||M===e.BEVELED?ee.push({leftPositions:N(G,C,K,M,l)}):ee.push({leftPositions:b(Z,n.negate(W,W),K,l)})):(K=n.add(Z,W,K),Y=n.add(K,n.negate(n.multiplyByScalar(Q,V,Y),Y),Y),G=n.add(K,n.negate(n.multiplyByScalar(Q,2*V,G),G),G),d[0]=n.clone(F,d[0]),d[1]=n.clone(Y,d[1]),q=P(t.generateArc({positions:d,granularity:j,ellipsoid:O}),Q,V,q),T&&(J.push(Q.x,Q.y,Q.z),X.push(I.x,I.y,I.z)),C=n.clone(G,C),Q=n.normalize(n.cross(I,L,Q),Q),G=n.add(K,n.negate(n.multiplyByScalar(Q,2*V,G),G),G),F=n.add(K,n.negate(n.multiplyByScalar(Q,V,F),F),F),M===e.ROUNDED||M===e.BEVELED?ee.push({rightPositions:N(K,C,G,M,l)}):ee.push({rightPositions:b(Z,W,G,l)})),H=n.negate(L,H)}Z=$}return I=O.geodeticSurfaceNormal(Z,I),d[0]=n.clone(F,d[0]),d[1]=n.clone(Z,d[1]),q=P(t.generateArc({positions:d,granularity:j,ellipsoid:O}),Q,V,q),T&&(J.push(Q.x,Q.y,Q.z),X.push(I.x,I.y,I.z)),M===e.ROUNDED&&(l=q,i=p,s=g,c=h,y=l[1],s=n.fromArray(l[1],y.length-3,s),c=n.fromArray(l[0],0,c),m=N(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1),A=l.length-1,D=l[A-1],y=l[A],s=n.fromArray(D,D.length-3,s),c=n.fromArray(y,0,c),U=[m,N(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1)]),{positions:q,corners:ee,lefts:J,normals:X,endPositions:U}};var U=s;export{U as a};