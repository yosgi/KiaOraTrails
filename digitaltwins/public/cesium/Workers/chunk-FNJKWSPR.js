import{a as t}from"./chunk-KSZ5EBRB.js";import{a as e,b as n}from"./chunk-V3DSE3OK.js";import{a as i}from"./chunk-FMRIJYNG.js";import{a as o,b as r,g as s}from"./chunk-YWRPWWKI.js";import{a as a,c as l,d as c}from"./chunk-JMSSU44E.js";import{a as p}from"./chunk-VLPNAR64.js";import{a as h,b as f}from"./chunk-GE5NEIZC.js";import{e as u}from"./chunk-35CVRQTC.js";var d=new o;function m(t,e){if(f.defined("origin",t),!u(t=(e=p(e,c.default)).scaleToGeodeticSurface(t)))throw new h("origin must not be at the center of the ellipsoid.");let n=s.eastNorthUpToFixedFrame(t,e);this._ellipsoid=e,this._origin=t,this._xAxis=a.fromCartesian4(r.getColumn(n,0,d)),this._yAxis=a.fromCartesian4(r.getColumn(n,1,d));let o=a.fromCartesian4(r.getColumn(n,2,d));this._plane=i.fromPointNormal(t,o)}Object.defineProperties(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var g=new t;m.fromPoints=function(e,n){return f.defined("cartesians",e),new m(t.fromPoints(e,g).center,n)};var _=new e,y=new a;m.prototype.projectPointOntoPlane=function(t,e){f.defined("cartesian",t),_.origin=t,a.normalize(t,_.direction);let i=n.rayPlane(_,this._plane,y);if(u(i)||(a.negate(_.direction,_.direction),i=n.rayPlane(_,this._plane,y)),u(i)){let t=a.subtract(i,this._origin,i),n=a.dot(this._xAxis,t),o=a.dot(this._yAxis,t);return u(e)?(e.x=n,e.y=o,e):new l(n,o)}},m.prototype.projectPointsOntoPlane=function(t,e){f.defined("cartesians",t),u(e)||(e=[]);let n=0,i=t.length;for(let o=0;o<i;o++){let i=this.projectPointOntoPlane(t[o],e[n]);u(i)&&(e[n]=i,n++)}return e.length=n,e},m.prototype.projectPointToNearestOnPlane=function(t,e){f.defined("cartesian",t),u(e)||(e=new l),_.origin=t,a.clone(this._plane.normal,_.direction);let i=n.rayPlane(_,this._plane,y);u(i)||(a.negate(_.direction,_.direction),i=n.rayPlane(_,this._plane,y));let o=a.subtract(i,this._origin,i),r=a.dot(this._xAxis,o),s=a.dot(this._yAxis,o);return e.x=r,e.y=s,e},m.prototype.projectPointsToNearestOnPlane=function(t,e){f.defined("cartesians",t),u(e)||(e=[]);let n=t.length;e.length=n;for(let i=0;i<n;i++)e[i]=this.projectPointToNearestOnPlane(t[i],e[i]);return e};var P=new a;m.prototype.projectPointOntoEllipsoid=function(t,e){f.defined("cartesian",t),u(e)||(e=new a);let n=this._ellipsoid,i=this._origin,o=this._xAxis,r=this._yAxis;return a.multiplyByScalar(o,t.x,P),e=a.add(i,P,e),a.multiplyByScalar(r,t.y,P),a.add(e,P,e),n.scaleToGeocentricSurface(e,e),e},m.prototype.projectPointsOntoEllipsoid=function(t,e){f.defined("cartesians",t);let n=t.length;u(e)?e.length=n:e=Array(n);for(let i=0;i<n;++i)e[i]=this.projectPointOntoEllipsoid(t[i],e[i]);return e};var x=m;export{x as a};