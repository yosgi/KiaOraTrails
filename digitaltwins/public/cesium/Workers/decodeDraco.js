import{a as t}from"./chunk-JCUVYVZU.js";import{a as e}from"./chunk-PWAJ3RAI.js";import{a as r}from"./chunk-NNHN6WUY.js";import{a as n}from"./chunk-VTVHUB7E.js";import"./chunk-4UYSGV57.js";import"./chunk-ANLJ4KBN.js";import{a as o}from"./chunk-ID6SFQTL.js";import"./chunk-VLPNAR64.js";import"./chunk-GE5NEIZC.js";import{d as a,e as i}from"./chunk-35CVRQTC.js";var s,u=a(t(),1);function l(t,e,r){let o=t.num_points(),a=r.num_components(),u,l=new s.AttributeQuantizationTransform;if(l.InitFromAttribute(r)){let t=Array(a);for(let e=0;e<a;++e)t[e]=l.min_value(e);u={quantizationBits:l.quantization_bits(),minValues:t,range:l.range(),octEncoded:!1}}s.destroy(l),(l=new s.AttributeOctahedronTransform).InitFromAttribute(r)&&(u={quantizationBits:l.quantization_bits(),octEncoded:!0}),s.destroy(l);let c=o*a,A;A=i(u)?function(t,e,r,n,o){let a,i;n.quantizationBits<=8?(i=new s.DracoUInt8Array,a=new Uint8Array(o),e.GetAttributeUInt8ForAllPoints(t,r,i)):n.quantizationBits<=16?(i=new s.DracoUInt16Array,a=new Uint16Array(o),e.GetAttributeUInt16ForAllPoints(t,r,i)):(i=new s.DracoFloat32Array,a=new Float32Array(o),e.GetAttributeFloatForAllPoints(t,r,i));for(let t=0;t<o;++t)a[t]=i.GetValue(t);return s.destroy(i),a}(t,e,r,u,c):function(t,e,r,n){let o,a;switch(r.data_type()){case 1:case 11:a=new s.DracoInt8Array,o=new Int8Array(n),e.GetAttributeInt8ForAllPoints(t,r,a);break;case 2:a=new s.DracoUInt8Array,o=new Uint8Array(n),e.GetAttributeUInt8ForAllPoints(t,r,a);break;case 3:a=new s.DracoInt16Array,o=new Int16Array(n),e.GetAttributeInt16ForAllPoints(t,r,a);break;case 4:a=new s.DracoUInt16Array,o=new Uint16Array(n),e.GetAttributeUInt16ForAllPoints(t,r,a);break;case 5:case 7:a=new s.DracoInt32Array,o=new Int32Array(n),e.GetAttributeInt32ForAllPoints(t,r,a);break;case 6:case 8:a=new s.DracoUInt32Array,o=new Uint32Array(n),e.GetAttributeUInt32ForAllPoints(t,r,a);break;case 9:case 10:a=new s.DracoFloat32Array,o=new Float32Array(n),e.GetAttributeFloatForAllPoints(t,r,a)}for(let t=0;t<n;++t)o[t]=a.GetValue(t);return s.destroy(a),o}(t,e,r,c);let y=n.fromTypedArray(A);return{array:A,data:{componentsPerAttribute:a,componentDatatype:y,byteOffset:r.byte_offset(),byteStride:n.getSizeInBytes(y)*a,normalized:r.normalized(),quantization:u}}}async function c(t,e){return i(t.bufferView)?function(t){let e=new s.Decoder;if(t.dequantizeInShader)for(let r=0;r<t.attributesToSkipTransform.length;++r)e.SkipAttributeTransform(s[t.attributesToSkipTransform[r]]);let n=t.bufferView,a=new s.DecoderBuffer;if(a.Init(t.array,n.byteLength),e.GetEncodedGeometryType(a)!==s.TRIANGULAR_MESH)throw new o("Unsupported draco mesh geometry type.");let i=new s.Mesh,u=e.DecodeBufferToMesh(a,i);if(!u.ok()||0===i.ptr)throw new o(`Error decoding draco mesh geometry: ${u.error_msg()}`);s.destroy(a);let c={},A=t.compressedAttributes;for(let t in A)if(A.hasOwnProperty(t)){let r=A[t],n=e.GetAttributeByUniqueId(i,r);c[t]=l(i,e,n)}let y={indexArray:function(t,e){let n=t.num_points(),o=t.num_faces(),a=new s.DracoInt32Array,i=3*o,u=r.createTypedArray(n,i),l=0;for(let r=0;r<o;++r)e.GetFaceFromMesh(t,r,a),u[l+0]=a.GetValue(0),u[l+1]=a.GetValue(1),u[l+2]=a.GetValue(2),l+=3;return s.destroy(a),{typedArray:u,numberOfIndices:i}}(i,e),attributeData:c};return s.destroy(i),s.destroy(e),y}(t):function(t){let e=new s.Decoder;t.dequantizeInShader&&(e.SkipAttributeTransform(s.POSITION),e.SkipAttributeTransform(s.NORMAL));let r=new s.DecoderBuffer;if(r.Init(t.buffer,t.buffer.length),e.GetEncodedGeometryType(r)!==s.POINT_CLOUD)throw new o("Draco geometry type must be POINT_CLOUD.");let n=new s.PointCloud,a=e.DecodeBufferToPointCloud(r,n);if(!a.ok()||0===n.ptr)throw new o(`Error decoding draco point cloud: ${a.error_msg()}`);s.destroy(r);let i={},u=t.properties;for(let t in u)if(u.hasOwnProperty(t)){let r;if("POSITION"===t||"NORMAL"===t){let o=e.GetAttributeId(n,s[t]);r=e.GetAttribute(n,o)}else{let o=u[t];r=e.GetAttributeByUniqueId(n,o)}i[t]=l(n,e,r)}return s.destroy(n),s.destroy(e),i}(t)}async function A(t,e){let r=t.webAssemblyConfig;return s=i(r)&&i(r.wasmBinaryFile)?await (0,u.default)(r):await (0,u.default)(),!0}var y=e(async function(t,e){return i(t.webAssemblyConfig)?A(t,e):c(t,e)});export{y as default};