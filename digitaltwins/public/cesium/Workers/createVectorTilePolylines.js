import{a as e}from"./chunk-PWAJ3RAI.js";import{a as r}from"./chunk-CXNPIJLB.js";import{a as t}from"./chunk-NNHN6WUY.js";import{c as n,h as a}from"./chunk-YWRPWWKI.js";import"./chunk-VTVHUB7E.js";import{a as o,b as s,d as u}from"./chunk-JMSSU44E.js";import{a as f}from"./chunk-4UYSGV57.js";import"./chunk-ANLJ4KBN.js";import"./chunk-ID6SFQTL.js";import"./chunk-VLPNAR64.js";import"./chunk-GE5NEIZC.js";import"./chunk-35CVRQTC.js";var i=new s,c=new o,p=function(e,t,n,a,u){let p=e.length/3,l=e.subarray(0,p),d=e.subarray(p,2*p),h=e.subarray(2*p,3*p);r.zigZagDeltaDecode(l,d,h);let k=new Float64Array(e.length);for(let e=0;e<p;++e){let r=l[e],p=d[e],b=h[e],m=f.lerp(t.west,t.east,r/32767),w=f.lerp(t.south,t.north,p/32767),y=f.lerp(n,a,b/32767),A=s.fromRadians(m,w,y,i),N=u.cartographicToCartesian(A,c);o.pack(N,k,3*e)}return k},l=new a,d=new u,h=new o,k={min:void 0,max:void 0},b=new o,m=new o,w=new o,y=new o,A=new o,N=e(function(e,r){var s;let f,i=new Uint16Array(e.positions),c=new Uint16Array(e.widths),N=new Uint32Array(e.counts),j=new Uint16Array(e.batchIds);s=new Float64Array(s=e.packedBuffer),f=0,k.min=s[f++],k.max=s[f++],a.unpack(s,f,l),f+=a.packedLength,u.unpack(s,f,d),f+=u.packedLength,o.unpack(s,f,h);let U=p(i,l,k.min,k.max,d),E=U.length/3,I=4*E-4,P=new Float32Array(3*I),g=new Float32Array(3*I),T=new Float32Array(3*I),S=new Float32Array(2*I),x=new Uint16Array(I),D=0,F=0,L=0,R,W=0,v=N.length;for(R=0;R<v;++R){let e=N[R],r=c[R],t=j[R];for(let n=0;n<e;++n){let a;if(0===n){let e=o.unpack(U,3*W,b),r=o.unpack(U,(W+1)*3,m);a=o.subtract(e,r,w),o.add(e,a,a)}else a=o.unpack(U,(W+n-1)*3,w);let s=o.unpack(U,(W+n)*3,y),u;if(n===e-1){let r=o.unpack(U,(W+e-1)*3,b),t=o.unpack(U,(W+e-2)*3,m);u=o.subtract(r,t,A),o.add(r,u,u)}else u=o.unpack(U,(W+n+1)*3,A);o.subtract(a,h,a),o.subtract(s,h,s),o.subtract(u,h,u);let f=2*(0===n),i=n===e-1?2:4;for(let e=f;e<i;++e){o.pack(s,P,D),o.pack(a,g,D),o.pack(u,T,D),D+=3;let n=e-2<0?-1:1;S[F++]=e%2*2-1,S[F++]=n*r,x[L++]=t}}W+=e}let B=t.createTypedArray(I,6*E-6),C=0,V=0;for(v=E-1,R=0;R<v;++R)B[V++]=C,B[V++]=C+2,B[V++]=C+1,B[V++]=C+1,B[V++]=C+2,B[V++]=C+3,C+=4;r.push(P.buffer,g.buffer,T.buffer),r.push(S.buffer,x.buffer,B.buffer);let G={indexDatatype:2===B.BYTES_PER_ELEMENT?t.UNSIGNED_SHORT:t.UNSIGNED_INT,currentPositions:P.buffer,previousPositions:g.buffer,nextPositions:T.buffer,expandAndWidth:S.buffer,batchIds:x.buffer,indices:B.buffer};if(e.keepDecodedPositions){let e=function(e){let r=e.length,t=new Uint32Array(r+1),n=0;for(let a=0;a<r;++a)t[a]=n,n+=e[a];return t[r]=n,t}(N);r.push(U.buffer,e.buffer),G=n(G,{decodedPositions:U.buffer,decodedPositionOffsets:e.buffer})}return G});export{N as default};