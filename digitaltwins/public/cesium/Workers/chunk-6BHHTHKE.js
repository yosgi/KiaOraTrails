import{a as e}from"./chunk-M5SITFFN.js";import{a as t}from"./chunk-FNJKWSPR.js";import{a as r,b as n,f as o,g as a}from"./chunk-YWRPWWKI.js";import{a as l,b as i,c as s,e as c}from"./chunk-JMSSU44E.js";import{a as u}from"./chunk-4UYSGV57.js";import{a as d}from"./chunk-VLPNAR64.js";import{a as m}from"./chunk-GE5NEIZC.js";import{e as g}from"./chunk-35CVRQTC.js";var h=Object.freeze({ROUNDED:0,MITERED:1,BEVELED:2}),y={};function f(e,t){if(!g(e))throw new m("identifier is required.");g(y[e])||(y[e]=!0,console.warn(d(t,e)))}f.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",f.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",f.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",f.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var p=f,w=[new l,new l],E=new l,x=new l,b=new l,S=new l,B=new l,z=new l,P=new l,R=new l,T=new l,A=new l,v=new l,j={},D=new i;function I(e,t,r,n){let o=e[0],a=e[1],i=Math.ceil(l.angleBetween(o,a)/n),s=Array(i),c;if(t===r){for(c=0;c<i;c++)s[c]=t;return s.push(r),s}let u=(r-t)/i;for(c=1;c<i;c++){let e=t+c*u;s[c]=e}return s[0]=t,s.push(r),s}var N=new l,O=new l,V=new l(-1,0,0),G=new n,k=new n,F=new c,M=c.IDENTITY.clone(),H=new l,L=new r,U=new l;function q(e,r,o,i,u,d,m,g){var h;let y,f,p,w,E=H,x=L;G=a.eastNorthUpToFixedFrame(e,u,G),E=n.multiplyByPointAsVector(G,V,E);let b=(h=E=l.normalize(E,E),f=(y=new t(e,u)).projectPointOntoPlane(l.add(e,h,N),N),p=y.projectPointOntoPlane(l.add(e,r,O),O),w=s.angleBetween(f,p),p.x*f.y-p.y*f.x>=0?-w:w);F=c.fromRotationZ(b,F),U.z=d,G=n.multiplyTransformation(G,n.fromRotationTranslation(F,U,k),G),M[0]=m;for(let e=0;e<g;e++)for(let e=0;e<o.length;e+=3)x=l.fromArray(o,e,x),x=c.multiplyByVector(M,x,x),x=n.multiplyByPoint(G,x,x),i.push(x.x,x.y,x.z);return i}var C=new l;function W(e,t,r,n,o,a,i){for(let s=0;s<e.length;s+=3)n=q(l.fromArray(e,s,C),t,r,n,o,a[s/3],i,1);return n}function Q(e,t){let r=e.length,n=Array(3*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2;for(let t=0;t<r;t++)n[o++]=e[t].x-a,n[o++]=0,n[o++]=e[t].y-l;return n}var Y=new o,Z=new l,_=new c;function J(e,t,r,n,a,i,s,d,m,g){let y,f,p=l.angleBetween(l.subtract(t,e,A),l.subtract(r,e,v)),w=n===h.BEVELED?0:Math.ceil(p/u.toRadians(5)),E;if(E=a?c.fromQuaternion(o.fromAxisAngle(l.negate(e,A),p/(w+1),Y),_):c.fromQuaternion(o.fromAxisAngle(e,p/(w+1),Y),_),t=l.clone(t,Z),w>0){let r=g?2:1;for(let n=0;n<w;n++)t=c.multiplyByVector(E,t,t),y=l.subtract(t,e,A),y=l.normalize(y,y),a||(y=l.negate(y,y)),s=q(i.scaleToGeodeticSurface(t,v),y,d,s,i,m,1,r)}else y=l.subtract(t,e,A),y=l.normalize(y,y),a||(y=l.negate(y,y)),s=q(i.scaleToGeodeticSurface(t,v),y,d,s,i,m,1,1),r=l.clone(r,Z),y=l.subtract(r,e,A),y=l.normalize(y,y),a||(y=l.negate(y,y)),s=q(i.scaleToGeodeticSurface(r,v),y,d,s,i,m,1,1);return s}j.removeDuplicatesFromShape=function(e){let t=e.length,r=[];for(let n=t-1,o=0;o<t;n=o++){let t=e[n],a=e[o];s.equals(t,a)||r.push(a)}return r},j.angleIsGreaterThanPi=function(e,r,n,o){let a=new t(n,o),i=a.projectPointOntoPlane(l.add(n,e,N),N),s=a.projectPointOntoPlane(l.add(n,r,O),O);return s.x*i.y-s.y*i.x>=0};var K=new l,X=new l;j.computePositions=function(t,r,n,o,a){let i,s,c=o._ellipsoid,d=function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let o=e[n];D=t.cartesianToCartographic(o,D),r[n]=D.height,e[n]=t.scaleToGeodeticSurface(o,o)}return r}(t,c),m=o._granularity,g=o._cornerType,y=a?function(e,t){let r=e.length,n=Array(6*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2,i=e[0];n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l;for(let t=1;t<r;t++){let r=(i=e[t]).x-a,s=i.y-l;n[o++]=r,n[o++]=0,n[o++]=s,n[o++]=r,n[o++]=0,n[o++]=s}return i=e[0],n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l,n}(r,n):Q(r,n),f=a?Q(r,n):void 0,v=n.height/2,N=n.width/2,O=t.length,V=[],G=a?[]:void 0,k=E,F=x,M=b,H=S,L=B,U=z,C=P,Y=R,Z=T,_=t[0],$=t[1];H=c.geodeticSurfaceNormal(_,H),k=l.subtract($,_,k),k=l.normalize(k,k),Y=l.cross(H,k,Y),Y=l.normalize(Y,Y);let ee=d[0],et=d[1];a&&(G=q(_,Y,f,G,c,ee+v,1,1)),Z=l.clone(_,Z),_=$,F=l.negate(k,F);for(let r=1;r<O-1;r++){let n=a?2:1;if($=t[r+1],_.equals($)){p("Positions are too close and are considered equivalent with rounding error.");continue}k=l.subtract($,_,k),k=l.normalize(k,k),H=c.geodeticSurfaceNormal(_,H);let o=l.multiplyByScalar(H,l.dot(k,H),K);l.subtract(k,o,o),l.normalize(o,o);let s=l.multiplyByScalar(H,l.dot(F,H),X);if(l.subtract(F,s,s),l.normalize(s,s),u.equalsEpsilon(Math.abs(l.dot(o,s)),1,u.EPSILON7))V=q(Z,Y,y,V,c,ee+v,1,1),Z=_;else{M=l.add(k,F,M),M=l.normalize(M,M),M=l.cross(M,H,M),M=l.cross(H,M,M),M=l.normalize(M,M);let t=1/Math.max(.25,l.magnitude(l.cross(M,F,A))),r=j.angleIsGreaterThanPi(k,F,_,c);r?(L=l.add(_,l.multiplyByScalar(M,t*N,M),L),U=l.add(L,l.multiplyByScalar(Y,N,U),U),w[0]=l.clone(Z,w[0]),w[1]=l.clone(U,w[1]),i=I(w,ee+v,et+v,m),V=W(e.generateArc({positions:w,granularity:m,ellipsoid:c}),Y,y,V,c,i,1),Y=l.cross(H,k,Y),Y=l.normalize(Y,Y),C=l.add(L,l.multiplyByScalar(Y,N,C),C),g===h.ROUNDED||g===h.BEVELED?J(L,U,C,g,r,c,V,y,et+v,a):V=q(_,M=l.negate(M,M),y,V,c,et+v,t,n)):(L=l.add(_,l.multiplyByScalar(M,t*N,M),L),U=l.add(L,l.multiplyByScalar(Y,-N,U),U),w[0]=l.clone(Z,w[0]),w[1]=l.clone(U,w[1]),i=I(w,ee+v,et+v,m),V=W(e.generateArc({positions:w,granularity:m,ellipsoid:c}),Y,y,V,c,i,1),Y=l.cross(H,k,Y),Y=l.normalize(Y,Y),C=l.add(L,l.multiplyByScalar(Y,-N,C),C),g===h.ROUNDED||g===h.BEVELED?J(L,U,C,g,r,c,V,y,et+v,a):V=q(_,M,y,V,c,et+v,t,n)),Z=l.clone(C,Z),F=l.negate(k,F)}ee=et,et=d[r+1],_=$}w[0]=l.clone(Z,w[0]),w[1]=l.clone(_,w[1]),i=I(w,ee+v,et+v,m),V=W(e.generateArc({positions:w,granularity:m,ellipsoid:c}),Y,y,V,c,i,1),a&&(G=q(_,Y,f,G,c,et+v,1,1)),O=V.length;let er=new Float64Array(a?O+G.length:O);return er.set(V),a&&er.set(G,O),er};var $=j;export{h as a,p as b,$ as c};