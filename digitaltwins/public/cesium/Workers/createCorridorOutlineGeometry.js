import{a as t}from"./chunk-UV3CO6HM.js";import{a as e}from"./chunk-6BHHTHKE.js";import"./chunk-M5SITFFN.js";import"./chunk-ZPYKVVFF.js";import{a as i}from"./chunk-ZFTFDHK4.js";import"./chunk-FNJKWSPR.js";import"./chunk-KSZ5EBRB.js";import{b as r}from"./chunk-CKMJZ5B3.js";import{a as o}from"./chunk-WNTCOVG2.js";import"./chunk-EEKB62LQ.js";import"./chunk-V3DSE3OK.js";import"./chunk-FMRIJYNG.js";import{a as s}from"./chunk-NNHN6WUY.js";import{a as n}from"./chunk-T7ERZ2CJ.js";import{b as a,c as l,d as h}from"./chunk-GSNDLQ4C.js";import{d as u}from"./chunk-BKSIEBAA.js";import"./chunk-YWRPWWKI.js";import{a as p}from"./chunk-VTVHUB7E.js";import{a as f,d as c}from"./chunk-JMSSU44E.js";import{a as d}from"./chunk-4UYSGV57.js";import"./chunk-ANLJ4KBN.js";import"./chunk-ID6SFQTL.js";import{a as g}from"./chunk-VLPNAR64.js";import{b as m}from"./chunk-GE5NEIZC.js";import{e as y}from"./chunk-35CVRQTC.js";var A=new f,_=new f,b=new f;function k(i,r){let o=[],a=i.positions,l=i.corners,u=i.endPositions,c=new n,d,g=0,m=0,k,E=0,T;for(k=0;k<a.length;k+=2)g+=T=a[k].length-3,E+=T/3*4,m+=a[k+1].length-3;for(g+=3,m+=3,k=0;k<l.length;k++){d=l[k];let t=l[k].leftPositions;y(t)?g+=T=t.length:m+=T=l[k].rightPositions.length,E+=T/3*2}let j=y(u),v;j&&(g+=v=u[0].length-3,m+=v,v/=3,E+=4*v);let w=g+m,N=new Float64Array(w),H=0,O=w-1,P,S,L,D,B,G,I=v/2,V=s.createTypedArray(w/3,E+4),F=0;if(V[F++]=H/3,V[F++]=(O-2)/3,j){o.push(H/3),G=A,B=_;let e=u[0];for(k=0;k<I;k++)G=f.fromArray(e,(I-1-k)*3,G),B=f.fromArray(e,(I+k)*3,B),t.addAttribute(N,B,H),t.addAttribute(N,G,void 0,O),D=(S=H/3)+1,L=(P=(O-2)/3)-1,V[F++]=P,V[F++]=L,V[F++]=S,V[F++]=D,H+=3,O-=3}let R=0,U=a[R++],x=a[R++];for(N.set(U,H),N.set(x,O-x.length+1),T=x.length-3,o.push(H/3,(O-2)/3),k=0;k<T;k+=3)D=(S=H/3)+1,L=(P=(O-2)/3)-1,V[F++]=P,V[F++]=L,V[F++]=S,V[F++]=D,H+=3,O-=3;for(k=0;k<l.length;k++){let i;let s=(d=l[k]).leftPositions,n=d.rightPositions,h,u=b;if(y(s)){for(O-=3,h=L,o.push(D),i=0;i<s.length/3;i++)u=f.fromArray(s,3*i,u),V[F++]=h-i-1,V[F++]=h-i,t.addAttribute(N,u,void 0,O),O-=3;o.push(h-Math.floor(s.length/6)),r===e.BEVELED&&o.push((O-2)/3+1),H+=3}else{for(H+=3,h=D,o.push(L),i=0;i<n.length/3;i++)u=f.fromArray(n,3*i,u),V[F++]=h+i,V[F++]=h+i+1,t.addAttribute(N,u,H),H+=3;o.push(h+Math.floor(n.length/6)),r===e.BEVELED&&o.push(H/3-1),O-=3}for(U=a[R++],x=a[R++],U.splice(0,3),x.splice(x.length-3,3),N.set(U,H),N.set(x,O-x.length+1),T=x.length-3,i=0;i<x.length;i+=3)S=(D=H/3)-1,P=(L=(O-2)/3)+1,V[F++]=P,V[F++]=L,V[F++]=S,V[F++]=D,H+=3,O-=3;H-=3,O+=3,o.push(H/3,(O-2)/3)}if(j){H+=3,O-=3,G=A,B=_;let e=u[1];for(k=0;k<I;k++)G=f.fromArray(e,(v-k-1)*3,G),B=f.fromArray(e,3*k,B),t.addAttribute(N,G,void 0,O),t.addAttribute(N,B,H),S=(D=H/3)-1,P=(L=(O-2)/3)+1,V[F++]=P,V[F++]=L,V[F++]=S,V[F++]=D,H+=3,O-=3;o.push(H/3)}else o.push(H/3,(O-2)/3);return V[F++]=H/3,V[F++]=(O-2)/3,c.position=new h({componentDatatype:p.DOUBLE,componentsPerAttribute:3,values:N}),{attributes:c,indices:V,wallIndices:o}}function E(t){let i=(t=g(t,g.EMPTY_OBJECT)).positions,r=t.width;m.typeOf.object("options.positions",i),m.typeOf.number("options.width",r);let o=g(t.height,0),s=g(t.extrudedHeight,o);this._positions=i,this._ellipsoid=c.clone(g(t.ellipsoid,c.default)),this._width=r,this._height=Math.max(o,s),this._extrudedHeight=Math.min(o,s),this._cornerType=g(t.cornerType,e.ROUNDED),this._granularity=g(t.granularity,d.RADIANS_PER_DEGREE),this._offsetAttribute=t.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+i.length*f.packedLength+c.packedLength+6}E.pack=function(t,e,i){m.typeOf.object("value",t),m.typeOf.object("array",e),i=g(i,0);let r=t._positions,o=r.length;e[i++]=o;for(let t=0;t<o;++t,i+=f.packedLength)f.pack(r[t],e,i);return c.pack(t._ellipsoid,e,i),i+=c.packedLength,e[i++]=t._width,e[i++]=t._height,e[i++]=t._extrudedHeight,e[i++]=t._cornerType,e[i++]=t._granularity,e[i]=g(t._offsetAttribute,-1),e};var T=c.clone(c.UNIT_SPHERE),j={positions:void 0,ellipsoid:T,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};E.unpack=function(t,e,i){m.typeOf.object("array",t),e=g(e,0);let r=t[e++],o=Array(r);for(let i=0;i<r;++i,e+=f.packedLength)o[i]=f.unpack(t,e);let s=c.unpack(t,e,T);e+=c.packedLength;let n=t[e++],a=t[e++],l=t[e++],h=t[e++],u=t[e++],p=t[e];return y(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=n,i._height=a,i._extrudedHeight=l,i._cornerType=h,i._granularity=u,i._offsetAttribute=-1===p?void 0:p,i):(j.positions=o,j.width=n,j.height=a,j.extrudedHeight=l,j.cornerType=h,j.granularity=u,j.offsetAttribute=-1===p?void 0:p,new E(j))},E.createGeometry=function(e){let n=e._positions,c=e._width,g=e._ellipsoid,m=o(n=function(t,e){for(let i=0;i<t.length;i++)t[i]=e.scaleToGeodeticSurface(t[i],t[i]);return t}(n,g),f.equalsEpsilon);if(m.length<2||c<=0)return;let A=e._height,_=e._extrudedHeight,b=!d.equalsEpsilon(A,_,0,d.EPSILON2),E={ellipsoid:g,positions:m,width:c,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},T;if(b)E.height=A,E.extrudedHeight=_,E.offsetAttribute=e._offsetAttribute,T=function(e){let o,n,a=e.ellipsoid,l=k(t.computePositions(e),e.cornerType),u=l.wallIndices,f=e.height,c=e.extrudedHeight,d=l.attributes,g=l.indices,m=d.position.values,A=m.length,_=new Float64Array(A);_.set(m);let b=new Float64Array(2*A);if(m=r.scaleToGeodeticHeight(m,f,a),_=r.scaleToGeodeticHeight(_,c,a),b.set(m),b.set(_,A),d.position.values=b,A/=3,y(e.offsetAttribute)){let t=new Uint8Array(2*A);if(e.offsetAttribute===i.TOP)t=t.fill(1,0,A);else{let r=+(e.offsetAttribute!==i.NONE);t=t.fill(r)}d.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let E,T=g.length,j=s.createTypedArray(b.length/3,(T+u.length)*2);j.set(g);let v=T;for(E=0;E<T;E+=2){let t=g[E],e=g[E+1];j[v++]=t+A,j[v++]=e+A}for(E=0;E<u.length;E++)n=(o=u[E])+A,j[v++]=o,j[v++]=n;return{attributes:d,indices:j}}(E);else if((T=k(t.computePositions(E),E.cornerType)).attributes.position.values=r.scaleToGeodeticHeight(T.attributes.position.values,A,g),y(e._offsetAttribute)){let t=T.attributes.position.values.length,r=+(e._offsetAttribute!==i.NONE),o=new Uint8Array(t/3).fill(r);T.attributes.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})}let j=T.attributes,v=u.fromVertices(j.position.values,void 0,3);return new l({attributes:j,indices:T.indices,primitiveType:a.LINES,boundingSphere:v,offsetAttribute:e._offsetAttribute})};var v=function(t,e){return y(e)&&(t=E.unpack(t,e)),t._ellipsoid=c.clone(t._ellipsoid),E.createGeometry(t)};export{v as default};