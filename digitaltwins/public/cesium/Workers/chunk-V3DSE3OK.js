import{c as e}from"./chunk-BKSIEBAA.js";import{a as t,b as r,e as n}from"./chunk-JMSSU44E.js";import{a as i}from"./chunk-4UYSGV57.js";import{a as o}from"./chunk-VLPNAR64.js";import{a as a,b as u}from"./chunk-GE5NEIZC.js";import{e as s}from"./chunk-35CVRQTC.js";var l={};function f(e,t,r){let n=e+t;return i.sign(e)!==i.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<r?0:n}l.computeDiscriminant=function(e,t,r){if("number"!=typeof e)throw new a("a is a required number.");if("number"!=typeof t)throw new a("b is a required number.");if("number"!=typeof r)throw new a("c is a required number.");return t*t-4*e*r},l.computeRealRoots=function(e,t,r){let n;if("number"!=typeof e)throw new a("a is a required number.");if("number"!=typeof t)throw new a("b is a required number.");if("number"!=typeof r)throw new a("c is a required number.");if(0===e)return 0===t?[]:[-r/t];if(0===t){if(0===r)return[0,0];let t=Math.abs(r),o=Math.abs(e);if(t<o&&t/o<i.EPSILON14)return[0,0];if(t>o&&o/t<i.EPSILON14||(n=-r/e)<0)return[];let a=Math.sqrt(n);return[-a,a]}if(0===r)return(n=-t/e)<0?[n,0]:[0,n];let o=f(t*t,-(4*e*r),i.EPSILON14);if(o<0)return[];let u=-.5*f(t,i.sign(t)*Math.sqrt(o),i.EPSILON14);return t>0?[u/e,r/u]:[r/u,u/e]};var c={};function h(e,t,r,n){let i=t/3,o=r/3,a=e*o,u=i*n,s=i*i,l=o*o,f=e*o-s,c=e*n-i*o,h=i*n-l,w=4*f*h-c*c,m,d;if(w<0){let t,r,p;s*u>=a*l?(t=e,r=f,p=-2*i*f+e*c):(t=n,r=h,p=-n*c+2*o*h);let b=-(p<0?-1:1)*Math.abs(t)*Math.sqrt(-w),g=(d=-p+b)/2,q=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),M=d===b?-q:-r/q;return m=r<=0?q+M:-p/(q*q+M*M+r),s*u>=a*l?[(m-i)/e]:[-n/(m+o)]}let p=Math.sqrt(w),b=Math.sqrt(3)/2,g=Math.abs(Math.atan2(e*p,-(-2*i*f+e*c))/3),q=Math.cos(g);d=(m=2*Math.sqrt(-f))*q;let M=m*(-q/2-b*Math.sin(g)),y=d+M>2*i?d-i:M-i,S=y/e;g=Math.abs(Math.atan2(n*p,-(-n*c+2*o*h))/3),d=(m=2*Math.sqrt(-h))*(q=Math.cos(g)),M=m*(-q/2-b*Math.sin(g));let R=-n,O=d+M<2*o?d+o:M+o,P=R/O,N=-y*O-e*R,E=(o*N-y*R*i)/(-i*N+e*O*o);return S<=E?S<=P?E<=P?[S,E,P]:[S,P,E]:[P,S,E]:S<=P?[E,S,P]:E<=P?[E,P,S]:[P,E,S]}c.computeDiscriminant=function(e,t,r,n){if("number"!=typeof e)throw new a("a is a required number.");if("number"!=typeof t)throw new a("b is a required number.");if("number"!=typeof r)throw new a("c is a required number.");if("number"!=typeof n)throw new a("d is a required number.");let i=t*t,o=r*r;return 18*e*t*r*n+i*o-e*e*27*(n*n)-4*(e*o*r+i*t*n)},c.computeRealRoots=function(e,t,r,n){let i,o;if("number"!=typeof e)throw new a("a is a required number.");if("number"!=typeof t)throw new a("b is a required number.");if("number"!=typeof r)throw new a("c is a required number.");if("number"!=typeof n)throw new a("d is a required number.");if(0===e)return l.computeRealRoots(t,r,n);if(0===t){if(0===r){if(0===n)return[0,0,0];let t=(o=-n/e)<0?-Math.pow(-o,1/3):Math.pow(o,1/3);return[t,t,t]}return 0===n?0===(i=l.computeRealRoots(e,0,r)).Length?[0]:[i[0],0,i[1]]:h(e,0,r,n)}return 0===r?0===n?(o=-t/e)<0?[o,0,0]:[0,0,o]:h(e,t,0,n):0===n?0===(i=l.computeRealRoots(e,t,r)).length?[0]:i[1]<=0?[i[0],i[1],0]:i[0]>=0?[0,i[0],i[1]]:[i[0],0,i[1]]:h(e,t,r,n)};var w={};function m(e,r){r=t.clone(o(r,t.ZERO)),t.equals(r,t.ZERO)||t.normalize(r,r),this.origin=t.clone(o(e,t.ZERO)),this.direction=r}w.computeDiscriminant=function(e,t,r,n,i){if("number"!=typeof e)throw new a("a is a required number.");if("number"!=typeof t)throw new a("b is a required number.");if("number"!=typeof r)throw new a("c is a required number.");if("number"!=typeof n)throw new a("d is a required number.");if("number"!=typeof i)throw new a("e is a required number.");let o=e*e,u=t*t,s=u*t,l=r*r,f=l*r,c=n*n,h=c*n,w=i*i;return u*l*c-4*s*h-4*e*f*c+18*e*t*r*h-27*o*c*c+o*e*256*(w*i)+i*(18*s*r*n-4*u*f+16*e*l*l-80*e*t*l*n-6*e*u*c+144*o*r*c)+w*(144*e*u*r-27*u*u-128*o*l-192*o*t*n)},w.computeRealRoots=function(e,t,r,n,o){if("number"!=typeof e)throw new a("a is a required number.");if("number"!=typeof t)throw new a("b is a required number.");if("number"!=typeof r)throw new a("c is a required number.");if("number"!=typeof n)throw new a("d is a required number.");if("number"!=typeof o)throw new a("e is a required number.");if(Math.abs(e)<i.EPSILON15)return c.computeRealRoots(t,r,n,o);let u=t/e,s=r/e,f=n/e,h=o/e,w=+(u<0);switch(w+=s<0?w+1:w,w+=f<0?w+1:w,w+=h<0?w+1:w){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return function(e,t,r,n){let o=e*e,a=t-3*o/8,u=r-t*e/2+o*e/8,s=n-r*e/4+t*o/16-3*o*o/256,f=c.computeRealRoots(1,2*a,a*a-4*s,-u*u);if(f.length>0){let t=-e/4,r=f[f.length-1];if(Math.abs(r)<i.EPSILON14){let e=l.computeRealRoots(1,a,s);if(2===e.length){let r=e[0],n=e[1],i;if(r>=0&&n>=0){let e=Math.sqrt(r),i=Math.sqrt(n);return[t-i,t-e,t+e,t+i]}if(r>=0&&n<0)return[t-(i=Math.sqrt(r)),t+i];if(r<0&&n>=0)return[t-(i=Math.sqrt(n)),t+i]}}else if(r>0){let e=Math.sqrt(r),n=l.computeRealRoots(1,e,(a+r-u/e)/2),i=l.computeRealRoots(1,-e,(a+r+u/e)/2);return 0!==n.length?(n[0]+=t,n[1]+=t,0!==i.length?(i[0]+=t,i[1]+=t,n[1]<=i[0]?[n[0],n[1],i[0],i[1]]:i[1]<=n[0]?[i[0],i[1],n[0],n[1]]:n[0]>=i[0]&&n[1]<=i[1]?[i[0],n[0],n[1],i[1]]:i[0]>=n[0]&&i[1]<=n[1]?[n[0],i[0],i[1],n[1]]:n[0]>i[0]&&n[0]<i[1]?[i[0],n[0],i[1],n[1]]:[n[0],i[0],n[1],i[1]]):n):0!==i.length?(i[0]+=t,i[1]+=t,i):[]}}return[]}(u,s,f,h);case 1:case 2:case 5:case 8:case 11:return function(e,t,r,n){let o=e*e,a=c.computeRealRoots(1,-2*t,r*e+t*t-4*n,o*n-r*t*e+r*r);if(a.length>0){let u,s,f,c,h=a[0],w=t-h,m=w*w,d=e/2,p=w/2,b=m-4*n,g=m+4*Math.abs(n),q=o-4*h,M=o+4*Math.abs(h),y,S;if(h<0||b*M<q*g){let t=Math.sqrt(q);y=t/2,S=0===t?0:(e*p-r)/t}else{let t=Math.sqrt(b);y=0===t?0:(e*p-r)/t,S=t/2}0===d&&0===y?(u=0,s=0):i.sign(d)===i.sign(y)?s=h/(u=d+y):u=h/(s=d-y),0===p&&0===S?(f=0,c=0):i.sign(p)===i.sign(S)?c=n/(f=p+S):f=n/(c=p-S);let R=l.computeRealRoots(1,u,f),O=l.computeRealRoots(1,s,c);if(0!==R.length)return 0!==O.length?R[1]<=O[0]?[R[0],R[1],O[0],O[1]]:O[1]<=R[0]?[O[0],O[1],R[0],R[1]]:R[0]>=O[0]&&R[1]<=O[1]?[O[0],R[0],R[1],O[1]]:O[0]>=R[0]&&O[1]<=R[1]?[R[0],O[0],O[1],R[1]]:R[0]>O[0]&&R[0]<O[1]?[O[0],R[0],O[1],R[1]]:[R[0],O[0],R[1],O[1]]:R;if(0!==O.length)return O}return[]}(u,s,f,h);default:return}},m.clone=function(e,r){if(s(e))return s(r)?(r.origin=t.clone(e.origin),r.direction=t.clone(e.direction),r):new m(e.origin,e.direction)},m.getPoint=function(e,r,n){return u.typeOf.object("ray",e),u.typeOf.number("t",r),s(n)||(n=new t),n=t.multiplyByScalar(e.direction,r,n),t.add(e.origin,n,n)};var d=m,p={};p.rayPlane=function(e,r,n){if(!s(e))throw new a("ray is required.");if(!s(r))throw new a("plane is required.");s(n)||(n=new t);let o=e.origin,u=e.direction,l=r.normal,f=t.dot(l,u);if(Math.abs(f)<i.EPSILON15)return;let c=(-r.distance-t.dot(l,o))/f;if(!(c<0))return n=t.multiplyByScalar(u,c,n),t.add(o,n,n)};var b=new t,g=new t,q=new t,M=new t,y=new t;p.rayTriangleParametric=function(e,r,n,u,l){if(!s(e))throw new a("ray is required.");if(!s(r))throw new a("p0 is required.");if(!s(n))throw new a("p1 is required.");if(!s(u))throw new a("p2 is required.");l=o(l,!1);let f=e.origin,c=e.direction,h=t.subtract(n,r,b),w=t.subtract(u,r,g),m=t.cross(c,w,q),d=t.dot(h,m),p,S,R,O,P;if(l){if(d<i.EPSILON6||(p=t.subtract(f,r,M),(R=t.dot(p,m))<0||R>d)||(S=t.cross(p,h,y),(O=t.dot(c,S))<0||R+O>d))return;P=t.dot(w,S)/d}else{if(Math.abs(d)<i.EPSILON6)return;let e=1/d;if(p=t.subtract(f,r,M),(R=t.dot(p,m)*e)<0||R>1||(S=t.cross(p,h,y),(O=t.dot(c,S)*e)<0||R+O>1))return;P=t.dot(w,S)*e}return P},p.rayTriangle=function(e,r,n,i,o,a){let u=p.rayTriangleParametric(e,r,n,i,o);if(!(!s(u)||u<0))return s(a)||(a=new t),t.multiplyByScalar(e.direction,u,a),t.add(e.origin,a,a)};var S=new d;p.lineSegmentTriangle=function(e,r,n,i,o,u,l){if(!s(e))throw new a("v0 is required.");if(!s(r))throw new a("v1 is required.");if(!s(n))throw new a("p0 is required.");if(!s(i))throw new a("p1 is required.");if(!s(o))throw new a("p2 is required.");t.clone(e,S.origin),t.subtract(r,e,S.direction),t.normalize(S.direction,S.direction);let f=p.rayTriangleParametric(S,n,i,o,u);if(!(!s(f)||f<0||f>t.distance(e,r)))return s(l)||(l=new t),t.multiplyByScalar(S.direction,f,l),t.add(S.origin,l,l)};var R={root0:0,root1:0};function O(r,n,i){s(i)||(i=new e);let o=r.origin,a=r.direction,u=n.center,l=n.radius*n.radius,f=t.subtract(o,u,q),c=function(e,t,r,n){let i=t*t-4*e*r;if(i<0)return;if(i>0){let r=1/(2*e),o=Math.sqrt(i),a=(-t+o)*r,u=(-t-o)*r;return a<u?(n.root0=a,n.root1=u):(n.root0=u,n.root1=a),n}let o=-t/(2*e);if(0!==o)return n.root0=n.root1=o,n}(t.dot(a,a),2*t.dot(a,f),t.magnitudeSquared(f)-l,R);if(s(c))return i.start=c.root0,i.stop=c.root1,i}p.raySphere=function(e,t,r){if(!s(e))throw new a("ray is required.");if(!s(t))throw new a("sphere is required.");if(!(!s(r=O(e,t,r))||r.stop<0))return r.start=Math.max(r.start,0),r};var P=new d;p.lineSegmentSphere=function(e,r,n,i){if(!s(e))throw new a("p0 is required.");if(!s(r))throw new a("p1 is required.");if(!s(n))throw new a("sphere is required.");t.clone(e,P.origin);let o=t.subtract(r,e,P.direction),u=t.magnitude(o);if(t.normalize(o,o),!(!s(i=O(P,n,i))||i.stop<0||i.start>u))return i.start=Math.max(i.start,0),i.stop=Math.min(i.stop,u),i};var N=new t,E=new t;function L(e,t,r){let n=e+t;return i.sign(e)!==i.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<r?0:n}p.rayEllipsoid=function(r,n){if(!s(r))throw new a("ray is required.");if(!s(n))throw new a("ellipsoid is required.");let i=n.oneOverRadii,o=t.multiplyComponents(i,r.origin,N),u=t.multiplyComponents(i,r.direction,E),l=t.magnitudeSquared(o),f=t.dot(o,u),c,h,w,m,d;if(l>1){if(f>=0)return;let r=f*f;if(c=l-1,r<(w=(h=t.magnitudeSquared(u))*c))return;if(r>w){m=f*f-w;let t=(d=-f+Math.sqrt(m))/h,r=c/d;return t<r?new e(t,r):{start:r,stop:t}}let n=Math.sqrt(c/h);return new e(n,n)}return l<1?(c=l-1,m=f*f-(w=(h=t.magnitudeSquared(u))*c),new e(0,(d=-f+Math.sqrt(m))/h)):f<0?new e(0,-f/(h=t.magnitudeSquared(u))):void 0},p.quadraticVectorExpression=function(e,r,o,a,u){let s=a*a,f=u*u,c=(e[n.COLUMN1ROW1]-e[n.COLUMN2ROW2])*f,h=u*(a*L(e[n.COLUMN1ROW0],e[n.COLUMN0ROW1],i.EPSILON15)+r.y),m=e[n.COLUMN0ROW0]*s+e[n.COLUMN2ROW2]*f+a*r.x+o,d=f*L(e[n.COLUMN2ROW1],e[n.COLUMN1ROW2],i.EPSILON15),p=u*(a*L(e[n.COLUMN2ROW0],e[n.COLUMN0ROW2])+r.z),b,g=[];if(0===p&&0===d){if(0===(b=l.computeRealRoots(c,h,m)).length)return g;let e=b[0],r=Math.sqrt(Math.max(1-e*e,0));if(g.push(new t(a,u*e,-(u*r))),g.push(new t(a,u*e,u*r)),2===b.length){let e=b[1],r=Math.sqrt(Math.max(1-e*e,0));g.push(new t(a,u*e,-(u*r))),g.push(new t(a,u*e,u*r))}return g}let q=p*p,M=d*d,y=p*d,S=c*c+M,R=2*(h*c+y),O=2*m*c+h*h-M+q,P=2*(m*h-y),N=m*m-q;if(0===S&&0===R&&0===O&&0===P)return g;let E=(b=w.computeRealRoots(S,R,O,P,N)).length;if(0===E)return g;for(let e=0;e<E;++e){let r=b[e],n=r*r,o=Math.sqrt(Math.max(1-n,0)),s,l=(i.sign(c)===i.sign(m)?L(c*n+m,h*r,i.EPSILON12):i.sign(m)===i.sign(h*r)?L(c*n,h*r+m,i.EPSILON12):L(c*n+h*r,m,i.EPSILON12))*L(d*r,p,i.EPSILON15);l<0?g.push(new t(a,u*r,u*o)):l>0?g.push(new t(a,u*r,-(u*o))):0!==o?(g.push(new t(a,u*r,-(u*o))),g.push(new t(a,u*r,u*o)),++e):g.push(new t(a,u*r,u*o))}return g};var I=new t,v=new t,x=new t,C=new t,z=new t,U=new n,T=new n,B=new n,W=new n,V=new n,j=new n,k=new n,A=new t,Z=new t,D=new r;p.grazingAltitudeLocation=function(e,r){if(!s(e))throw new a("ray is required.");if(!s(r))throw new a("ellipsoid is required.");let o=e.origin,u=e.direction;if(!t.equals(o,t.ZERO)){let e=r.geodeticSurfaceNormal(o,I);if(t.dot(u,e)>=0)return o}let l=s(this.rayEllipsoid(e,r)),f=r.transformPositionToScaledSpace(u,I),c=t.normalize(f,f),h=t.mostOrthogonalAxis(f,C),w=t.normalize(t.cross(h,c,v),v),m=t.normalize(t.cross(c,w,x),x);U[0]=c.x,U[1]=c.y,U[2]=c.z,U[3]=w.x,U[4]=w.y,U[5]=w.z,U[6]=m.x,U[7]=m.y,U[8]=m.z;let d=n.transpose(U,T),b=n.fromScale(r.radii,B),g=n.fromScale(r.oneOverRadii,W);V[0]=0,V[1]=-u.z,V[2]=u.y,V[3]=u.z,V[4]=0,V[5]=-u.x,V[6]=-u.y,V[7]=u.x,V[8]=0;let q=n.multiply(n.multiply(d,g,j),V,j),M=n.multiply(n.multiply(q,b,k),U,k),y=n.multiplyByVector(q,o,z),S=p.quadraticVectorExpression(M,t.negate(y,I),0,0,1),R,O,P=S.length;if(P>0){let e=t.clone(t.ZERO,Z),a=Number.NEGATIVE_INFINITY;for(let r=0;r<P;++r){R=n.multiplyByVector(b,n.multiplyByVector(U,S[r],A),A);let i=t.normalize(t.subtract(R,o,C),C),s=t.dot(i,u);s>a&&(a=s,e=t.clone(R,e))}let s=r.cartesianToCartographic(e,D);return a=i.clamp(a,0,1),O=t.magnitude(t.subtract(e,o,C))*Math.sqrt(1-a*a),s.height=O=l?-O:O,r.cartographicToCartesian(s,new t)}};var G=new t;p.lineSegmentPlane=function(e,r,n,o){if(!s(e))throw new a("endPoint0 is required.");if(!s(r))throw new a("endPoint1 is required.");if(!s(n))throw new a("plane is required.");s(o)||(o=new t);let u=t.subtract(r,e,G),l=n.normal,f=t.dot(l,u);if(Math.abs(f)<i.EPSILON6)return;let c=t.dot(l,e),h=-(n.distance+c)/f;if(!(h<0||h>1))return t.multiplyByScalar(u,h,o),t.add(e,o,o),o},p.trianglePlaneIntersection=function(e,r,n,i){let o,u;if(!s(e)||!s(r)||!s(n)||!s(i))throw new a("p0, p1, p2, and plane are required.");let l=i.normal,f=i.distance,c=t.dot(l,e)+f<0,h=t.dot(l,r)+f<0,w=t.dot(l,n)+f<0,m;if((1==(m=0+(+!!c+ +!!h+ +!!w))||2===m)&&(o=new t,u=new t),1===m){if(c)return p.lineSegmentPlane(e,r,i,o),p.lineSegmentPlane(e,n,i,u),{positions:[e,r,n,o,u],indices:[0,3,4,1,2,4,1,4,3]};if(h)return p.lineSegmentPlane(r,n,i,o),p.lineSegmentPlane(r,e,i,u),{positions:[e,r,n,o,u],indices:[1,3,4,2,0,4,2,4,3]};if(w)return p.lineSegmentPlane(n,e,i,o),p.lineSegmentPlane(n,r,i,u),{positions:[e,r,n,o,u],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===m){if(!c)return p.lineSegmentPlane(r,e,i,o),p.lineSegmentPlane(n,e,i,u),{positions:[e,r,n,o,u],indices:[1,2,4,1,4,3,0,3,4]};if(!h)return p.lineSegmentPlane(n,r,i,o),p.lineSegmentPlane(e,r,i,u),{positions:[e,r,n,o,u],indices:[2,0,4,2,4,3,1,3,4]};else if(!w)return p.lineSegmentPlane(e,n,i,o),p.lineSegmentPlane(r,n,i,u),{positions:[e,r,n,o,u],indices:[0,1,4,0,4,3,2,3,4]}}};var Y=p;export{d as a,Y as b};